@model IEnumerable<EmployeeListViewModel>?

<div class="page-wrapper">
	<div class="content">
		<div class="page-header">
			<div class="page-title">
				<h4>User List</h4>
				<h6>Manage your User</h6>
			</div>
			<div class="page-btn">
				<a asp-controller="Employee" asp-action="NewUser" class="btn btn-added"><img src="~/img/icons/plus.svg" alt="img">Add User</a>
			</div>
		</div>

		<div class="card">
			<div class="card-body">
				<div class="table-top">
					<div class="search-set">
						<div class="search-path">
							<a class="btn btn-filter" id="filter_search">
								<img src="~/img/icons/filter.svg" alt="img">
								<span><img src="~/img/icons/closes.svg" alt="img"></span>
							</a>
						</div>
						<div class="search-input">
							<a class="btn btn-searchset"><img src="~/img/icons/search-white.svg" alt="img"></a>
						</div>
					</div>
					<div class="wordset">
						<ul>
							<li>
								<a data-bs-toggle="tooltip" data-bs-placement="top" title="pdf"><img src="~/img/icons/pdf.svg" alt="img"></a>
							</li>
							<li>
								<a data-bs-toggle="tooltip" data-bs-placement="top" title="excel"><img src="~/img/icons/excel.svg" alt="img"></a>
							</li>
							<li>
								<a data-bs-toggle="tooltip" data-bs-placement="top" title="print"><img src="~/img/icons/printer.svg" alt="img"></a>
							</li>
						</ul>
					</div>
				</div>

				<div class="card" id="filter_inputs">
					<div class="card-body pb-0">
						<div class="row">
							<div class="col-lg-2 col-sm-6 col-12">
								<div class="form-group">
									<input type="text" placeholder="Enter User Name">
								</div>
							</div>
							<div class="col-lg-2 col-sm-6 col-12">
								<div class="form-group">
									<input type="text" placeholder="Enter Phone">
								</div>
							</div>
							<div class="col-lg-2 col-sm-6 col-12">
								<div class="form-group">
									<input type="text" placeholder="Enter Email">
								</div>
							</div>
							<div class="col-lg-2 col-sm-6 col-12">
								<div class="form-group">
									<input type="text" class="datetimepicker cal-icon" placeholder="Choose Date">
								</div>
							</div>
							<div class="col-lg-2 col-sm-6 col-12">
								<div class="form-group">
									<select class="form-select">
										<option>Disable</option>
										<option>Enable</option>
									</select>
								</div>
							</div>
							<div class="col-lg-1 col-sm-6 col-12 ms-auto">
								<div class="form-group">
									<a class="btn btn-filters ms-auto"><img src="~/img/icons/search-whites.svg" alt="img"></a>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="table-responsive">
					<table id="userTable" class="table  datanew">
						<thead>
							<tr>
								<th>
									<label class="checkboxs">
										<input type="checkbox">
										<span class="checkmarks"></span>
									</label>
								</th>
								<th>Full Name </th>
								<th>User name </th>
								<th>Phone</th>
								<th>email</th>
								<th>Role</th>
								<th>Created On</th>
								<th>Status</th>
								<th>Action</th>
							</tr>
						</thead>
						<tbody>
							@if (Model is not null)
							{
								@foreach(var user in Model)
								{										
									<tr>
										<td>
											<label class="checkboxs">
												<input type="checkbox">
												<span class="checkmarks"></span>
											</label>
										</td>
										<td>@user.Employee.Name</td>
										<td>@user.Employee.User.UserName</td>
										<td>@user.Employee.User.PhoneNumber </td>
										<td>
											@if(User.IsInRole("Admin"))
											{
												@user.Employee.User.Email;
											}
											else
											{
												<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="fb8f9394969a88bb9e839a968b979ed5989496">[email&#160;protected]</a> 
											}
										</td>
										<td>
											@if (user.IListEmployeeRoles is not null)
											{
												@user.IListEmployeeRoles[0]
											}
											else
											{
												<p>N/D</p>
											}
										</td>
										<td>@user.Employee.CreatedOn.ToString("dd/MM/yyyy")</td>
										<td>
											@if(user.Employee.Status == true)
											{
												<span class="bg-lightgreen badges">Active</span>
											}
											else
											{
												<span class="bg-lightred badges">Restricted</span>
											}
										</td>
										<td>
											<a class="me-3" asp-controller="Employee" asp-action="UserEdit" asp-route-id="@user.Employee.Id">
												<img src="~/img/icons/edit.svg" alt="img">
											</a>
											<a class="me-3 confirm-text" data-id="@user.Employee.Id">
												<img src="~/img/icons/delete.svg" alt="img">
											</a>
										</td>
									</tr>	
								}
							}
					</table>
				</div>
			</div>
		</div>
	</div>
</div>


@section Scripts
{
	<script>
		$(document).ready(function () {

			if ($.fn.DataTable.isDataTable('#userTable')) {
				$('#userTable .dataTables_empty').html('No users found')
			}

			$(".confirm-text").on("click", function (e) {
				e.preventDefault();

				var userId = $(this).data("id");
				var deleteUrl = `/Employee/DeleteUser/${userId}`;
				var successRedirectUrl = '/Employee/UserLists';

				confirmAndDelete(deleteUrl, successRedirectUrl, "User");
			});
		});
	</script>
}